

======================================================================
IMPLEMENTATION COMPARISON
======================================================================

Testing baseline encoder...
======================================================================
NPU Encoder Block Initialization
======================================================================

✅ NPU device: /dev/accel/accel0
Loading Attention kernel (64x64)...
  ✅ Attention kernel loaded (2.04ms per tile)
Loading LayerNorm kernel...
  ✅ LayerNorm kernel loaded (0.12ms per operation)
Loading GELU kernel...
  ✅ GELU kernel loaded (0.19ms per operation)
Loading Matmul kernel (16x16)...
  ✅ Matmul kernel loaded (0.45ms per operation)

======================================================================
✅ NPU Encoder Block Ready!
======================================================================

  Baseline: 4.13ms avg

Testing DMA-optimized encoder...
======================================================================
NPU Encoder Block Initialization
======================================================================

✅ NPU device: /dev/accel/accel0
Loading Attention kernel (64x64)...
  ✅ Attention kernel loaded (2.04ms per tile)
Loading LayerNorm kernel...
  ✅ LayerNorm kernel loaded (0.12ms per operation)
Loading GELU kernel...
Traceback (most recent call last):
  File "/home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/test_encoder_block_dma_optimized.py", line 376, in <module>
    compare_implementations()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/test_encoder_block_dma_optimized.py", line 354, in compare_implementations
    optimized_encoder = NPUEncoderBlockDMAOptimized(pipeline_depth=2)
  File "/home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/test_encoder_block_dma_optimized.py", line 51, in __init__
    super().__init__()
    ~~~~~~~~~~~~~~~~^^
  File "/home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/test_encoder_block.py", line 41, in __init__
    self._load_gelu_kernel()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/test_encoder_block.py", line 138, in _load_gelu_kernel
    self.gelu_ctx = xrt.hw_context(self.device, uuid)
                    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
RuntimeError: DRM_IOCTL_AMDXDNA_CREATE_HWCTX IOCTL failed (err=-2): No such file or directory
