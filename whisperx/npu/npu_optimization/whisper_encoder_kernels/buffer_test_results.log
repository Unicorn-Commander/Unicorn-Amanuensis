======================================================================
XRT BUFFER ALLOCATION STRATEGY TESTING
======================================================================

Initializing NPU...
Loading: /home/ucadmin/UC-1/Unicorn-Amanuensis/whisperx/npu/npu_optimization/whisper_encoder_kernels/build_attention_64x64/attention_64x64.xclbin
‚úÖ Kernel loaded

Checking kernel arguments and group IDs:
  Arg 0: group_id = 131071
  Arg 1: group_id = 65537
  Arg 2: group_id = 131071
  Arg 3: group_id = 65536
  Arg 4: group_id = 65536
  Arg 5: group_id = 65536


======================================================================
TEST: 1/10: Baseline (group 1,2,3 with host_only)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.host_only
  Output flags: flags.host_only
  Instruction group_id: 1
  Input group_id: 2
  Output group_id: 3

‚úÖ Buffers created successfully
‚úÖ Data written to buffers
Executing kernel...
‚úÖ Execution completed: 2.40ms

Results:
  Non-zero values: 4096/4096 (100.0%)
  Value range: [-1, -1]
  Mean: -1.00
  Std: 0.00

üéâ SUCCESS! This configuration works!

======================================================================
TEST: 2/10: Working Mel Pattern (group 1,3,4)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.host_only
  Output flags: flags.host_only
  Instruction group_id: 1
  Input group_id: 3
  Output group_id: 4

‚úÖ Buffers created successfully
‚úÖ Data written to buffers
Executing kernel...
‚úÖ Execution completed: 2.09ms

Results:
  Non-zero values: 3734/4096 (91.2%)
  Value range: [-13, 10]
  Mean: -0.83
  Std: 3.54

üéâ SUCCESS! This configuration works!

======================================================================
TEST: 3/10: Device Only (group 1,2,3)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.device_only
  Output flags: flags.device_only
  Instruction group_id: 1
  Input group_id: 2
  Output group_id: 3


‚ùå ERROR: Bad BO flags (err=95): Operation not supported

======================================================================
TEST: 4/10: Device Only (group 1,3,4)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.device_only
  Output flags: flags.device_only
  Instruction group_id: 1
  Input group_id: 3
  Output group_id: 4


‚ùå ERROR: Bad BO flags (err=95): Operation not supported

======================================================================
TEST: 5/10: P2P (group 1,2,3)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.p2p
  Output flags: flags.p2p
  Instruction group_id: 1
  Input group_id: 2
  Output group_id: 3


‚ùå ERROR: Bad BO flags (err=95): Operation not supported

======================================================================
TEST: 6/10: Auto Allocate (no flags, group 1,2,3)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: 0
  Output flags: 0
  Instruction group_id: 1
  Input group_id: 2
  Output group_id: 3


‚ùå ERROR: __init__(): incompatible constructor arguments. The following argument types are supported:
    1. pyxrt.bo(arg0: pyxrt.device, arg1: int, arg2: pyxrt.bo.flags, arg3: int)
    2. pyxrt.bo(arg0: pyxrt.bo, arg1: int, arg2: int)

Invoked with: <pyxrt.device object at 0x70675cde3430>, 12288, 0, 131071

======================================================================
TEST: 7/10: Auto Allocate (no flags, group 1,3,4)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: 0
  Output flags: 0
  Instruction group_id: 1
  Input group_id: 3
  Output group_id: 4


‚ùå ERROR: __init__(): incompatible constructor arguments. The following argument types are supported:
    1. pyxrt.bo(arg0: pyxrt.device, arg1: int, arg2: pyxrt.bo.flags, arg3: int)
    2. pyxrt.bo(arg0: pyxrt.bo, arg1: int, arg2: int)

Invoked with: <pyxrt.device object at 0x70675cde3430>, 12288, 0, 65536

======================================================================
TEST: 8/10: Group 0 for input (0,1,2)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.host_only
  Output flags: flags.host_only
  Instruction group_id: 1
  Input group_id: 0
  Output group_id: 2

‚úÖ Buffers created successfully
‚úÖ Data written to buffers
Executing kernel...
‚úÖ Execution completed: 2.16ms

Results:
  Non-zero values: 3624/4096 (88.5%)
  Value range: [-13, 11]
  Mean: -1.18
  Std: 3.74

üéâ SUCCESS! This configuration works!

======================================================================
TEST: 9/10: Small Size Like Mel (800/80 bytes)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 800 bytes
  Output size: 80 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.host_only
  Output flags: flags.host_only
  Instruction group_id: 1
  Input group_id: 3
  Output group_id: 4

‚úÖ Buffers created successfully
‚úÖ Data written to buffers
Executing kernel...
‚úÖ Execution completed: 2.08ms

Results:
  Non-zero values: 80/80 (100.0%)
  Value range: [-1, -1]
  Mean: -1.00
  Std: 0.00

üéâ SUCCESS! This configuration works!

======================================================================
TEST: 10/10: Mixed Flags (device input, host output)
======================================================================
Configuration:
  Instructions: 300 bytes
  Input size: 12288 bytes
  Output size: 4096 bytes
  Instruction flags: flags.cacheable
  Input flags: flags.device_only
  Output flags: flags.host_only
  Instruction group_id: 1
  Input group_id: 2
  Output group_id: 3


‚ùå ERROR: Bad BO flags (err=95): Operation not supported


======================================================================
SUMMARY OF ALL TESTS
======================================================================

Baseline (group 1,2,3 with host_only):
  ‚úÖ SUCCESS (100.0% non-zero)

Working Mel Pattern (group 1,3,4):
  ‚úÖ SUCCESS (91.2% non-zero)

Device Only (group 1,2,3):
  ‚ùå ERROR: Bad BO flags (err=95): Operation not supported

Device Only (group 1,3,4):
  ‚ùå ERROR: Bad BO flags (err=95): Operation not supported

P2P (group 1,2,3):
  ‚ùå ERROR: Bad BO flags (err=95): Operation not supported

Auto Allocate (no flags, group 1,2,3):
  ‚ùå ERROR: __init__(): incompatible constructor arguments. The following argument types are supported:
    1. pyxrt.bo(arg0: pyxrt.device, arg1: int, arg2: pyxrt.bo.flags, arg3: int)
    2. pyxrt.bo(arg0: pyxrt.bo, arg1: int, arg2: int)

Invoked with: <pyxrt.device object at 0x70675cde3430>, 12288, 0, 131071

Auto Allocate (no flags, group 1,3,4):
  ‚ùå ERROR: __init__(): incompatible constructor arguments. The following argument types are supported:
    1. pyxrt.bo(arg0: pyxrt.device, arg1: int, arg2: pyxrt.bo.flags, arg3: int)
    2. pyxrt.bo(arg0: pyxrt.bo, arg1: int, arg2: int)

Invoked with: <pyxrt.device object at 0x70675cde3430>, 12288, 0, 65536

Group 0 for input (0,1,2):
  ‚úÖ SUCCESS (88.5% non-zero)

Small Size Like Mel (800/80 bytes):
  ‚úÖ SUCCESS (100.0% non-zero)

Mixed Flags (device input, host output):
  ‚ùå ERROR: Bad BO flags (err=95): Operation not supported

======================================================================
‚úÖ WORKING CONFIGURATIONS FOUND!
======================================================================

Configuration: Baseline (group 1,2,3 with host_only)
  instr_flags: flags.cacheable
  input_flags: flags.host_only
  output_flags: flags.host_only
  group_ids: instr=1, input=2, output=3

Configuration: Working Mel Pattern (group 1,3,4)
  instr_flags: flags.cacheable
  input_flags: flags.host_only
  output_flags: flags.host_only
  group_ids: instr=1, input=3, output=4

Configuration: Group 0 for input (0,1,2)
  instr_flags: flags.cacheable
  input_flags: flags.host_only
  output_flags: flags.host_only
  group_ids: instr=1, input=0, output=2

Configuration: Small Size Like Mel (800/80 bytes)
  instr_flags: flags.cacheable
  input_flags: flags.host_only
  output_flags: flags.host_only
  group_ids: instr=1, input=3, output=4

